<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UnderBunker: Survival Choice</title>
    <style>
        /* [ìŠ¤íƒ€ì¼ ì„¤ì •] - ë‹¤í¬ ëª¨ë“œ ë° ë°˜ì‘í˜• ë””ìì¸ */
        :root {
            --bg-color: #1a1a1a;
            --card-bg: #ffffff;
            --text-color: #333;
            --accent-color: #f39c12;
            --bar-bg: #444;
            --pop-color: #e74c3c;   /* ì¸êµ¬: ë¹¨ê°• */
            --food-color: #2ecc71;  /* ì‹ëŸ‰: ì´ˆë¡ */
            --def-color: #3498db;   /* ë¬´ë ¥: íŒŒë‘ */
            --san-color: #9b59b6;   /* ì´ì„±: ë³´ë¼ */
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: #fff;
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* 1. ìƒë‹¨ ìƒíƒœë°” (ì•„ì´ì½˜ + ê²Œì´ì§€) */
        #status-bar {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 600px;
            padding: 15px 0;
            background-color: rgba(0,0,0,0.3);
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 20%;
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background-color: var(--bar-bg);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            width: 50%; /* ì´ˆê¸°ê°’ */
            transition: width 0.3s ease;
        }
        
        /* ê° ì•„ì´ì½˜ ìœ„ì— ì‘ì€ ì  í‘œì‹œ (ìƒì¡´ ì—¬ë¶€) */
        .stat-dot {
            width: 6px;
            height: 6px;
            background: #fff;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.5;
        }

        /* 2. ë©”ì¸ ì¹´ë“œ ì˜ì—­ */
        #game-area {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            perspective: 1000px;
        }

        #card {
            width: 320px;
            height: 480px;
            background-color: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            text-align: center;
            color: var(--text-color);
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            user-select: none; /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
        }

        #card img {
            width: 100%;
            height: 250px;
            object-fit: cover; /* ë¹„ìœ¨ ìœ ì§€í•˜ë©° ê½‰ ì±„ìš°ê¸° */
            border-radius: 12px;
            margin-bottom: 15px;
            background-color: #eee;
        }

        #npc-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin: 5px 0;
            color: #555;
        }

        #question-text {
            font-size: 1.1rem;
            line-height: 1.5;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: keep-all;
        }

        /* ì„ íƒì§€ ì˜¤ë²„ë ˆì´ í…ìŠ¤íŠ¸ (ìŠ¤ì™€ì´í”„ ì‹œ í‘œì‹œ) */
        .choice-overlay {
            position: absolute;
            top: 20px;
            font-size: 2rem;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 10;
            text-shadow: 2px 2px 0 #fff;
        }
        .choice-left { left: 20px; color: #e74c3c; transform: rotate(-15deg); }
        .choice-right { right: 20px; color: #2ecc71; transform: rotate(15deg); }

        /* 3. í•˜ë‹¨ ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */
        #controls {
            width: 100%;
            max-width: 400px;
            display: flex;
            justify-content: space-between;
            padding: 20px;
            margin-bottom: 20px;
        }

        .btn {
            flex: 1;
            padding: 15px;
            margin: 0 10px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            color: white;
            transition: transform 0.1s;
        }
        
        .btn:active { transform: scale(0.95); }
        .btn-left { background-color: #e74c3c; } /* ê±°ì ˆ/ë¶€ì • */
        .btn-right { background-color: #2ecc71; } /* ìˆ˜ë½/ê¸ì • */

        /* 4. ê²Œì„ ì˜¤ë²„ í™”ë©´ */
        #game-over-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
        }
        .hidden { display: none !important; }
        
        #game-over-title { font-size: 3rem; color: #e74c3c; margin-bottom: 10px; }
        #game-over-desc { font-size: 1.2rem; margin-bottom: 30px; max-width: 80%; line-height: 1.6;}
        
        #restart-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            background: #fff;
            color: #000;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
        }
        #restart-btn:hover { background: #ddd; }

    </style>
</head>
<body>

    <header id="status-bar">
        <div class="stat-item" title="ì¸êµ¬">
            <span class="stat-icon">ğŸ‘¥</span>
            <div class="progress-container">
                <div class="progress-bar" id="bar-pop" style="background: var(--pop-color);"></div>
                <div class="stat-dot"></div>
            </div>
        </div>
        <div class="stat-item" title="ì‹ëŸ‰">
            <span class="stat-icon">ğŸ¥«</span>
            <div class="progress-container">
                <div class="progress-bar" id="bar-food" style="background: var(--food-color);"></div>
                <div class="stat-dot"></div>
            </div>
        </div>
        <div class="stat-item" title="ë¬´ë ¥">
            <span class="stat-icon">ğŸ›¡ï¸</span>
            <div class="progress-container">
                <div class="progress-bar" id="bar-def" style="background: var(--def-color);"></div>
                <div class="stat-dot"></div>
            </div>
        </div>
        <div class="stat-item" title="ì´ì„±">
            <span class="stat-icon">ğŸ§ </span>
            <div class="progress-container">
                <div class="progress-bar" id="bar-san" style="background: var(--san-color);"></div>
                <div class="stat-dot"></div>
            </div>
        </div>
    </header>

    <main id="game-area">
        <div id="card">
            <div class="choice-overlay choice-left" id="overlay-left">NOPE</div>
            <div class="choice-overlay choice-right" id="overlay-right">YEAH</div>

            <img id="npc-img" src="" alt="Character Image" onerror="this.src='https://placehold.co/300x250/gray/white?text=No+Image'">
            <h2 id="npc-name">ìºë¦­í„° ì´ë¦„</h2>
            <p id="question-text">ì§ˆë¬¸ ë‚´ìš©ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤.</p>
        </div>
    </main>

    <div id="controls">
        <button class="btn btn-left" id="btn-left">ì™¼ìª½ ì„ íƒ</button>
        <button class="btn btn-right" id="btn-right">ì˜¤ë¥¸ìª½ ì„ íƒ</button>
    </div>

    <div id="game-over-screen" class="hidden">
        <h1 id="game-over-title">GAME OVER</h1>
        <p id="game-over-desc">ì‚¬ë§ ì›ì¸ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
        <button id="restart-btn" onclick="startGame()">ë‹¤ì‹œ ì‹œì‘</button>
    </div>

    <script>
        // [ê²Œì„ ë°ì´í„° ì„¤ì • - JSON í˜•ì‹]
        // ì´ë¯¸ì§€ ê²½ë¡œëŠ” game/images/ í´ë”ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë¨
        const events = [
            {
                id: 1,
                npc: "ìˆ˜ìƒí•œ ìš”ë¦¬ì‚¬",
                image: "images/chef.png",
                text: "ì°½ê³  êµ¬ì„ì—ì„œ ìœ í†µê¸°í•œì´ ì§€ì›Œì§„ ê³ ê¸°ë¥¼ ë°œê²¬í–ˆë„¤. ëƒ„ìƒˆëŠ”... ê³ ì†Œí•œë°?",
                left: { text: "ë°°ì‹í•œë‹¤", effects: { pop: -5, food: 15, san: -10, def: 0 } },
                right: { text: "íƒœì›Œë²„ë ¤", effects: { pop: 0, food: -10, san: 5, def: 0 } }
            },
            {
                id: 2,
                npc: "ë³´ì•ˆëŒ€ì¥",
                image: "images/soldier.png",
                text: "ì™¸ë¶€ ê²©ë²½ì„ ëˆ„êµ°ê°€ ë‘ë“œë¦°ë‹¤! ì‚¬ëŒì¼ê¹Œ, ë˜‘ë˜‘í•œ ì¢€ë¹„ì¼ê¹Œ?",
                left: { text: "ë¬¸ì„ ì—°ë‹¤", effects: { pop: 10, food: -15, san: 0, def: -5 } },
                right: { text: "ë°œí¬í•´!", effects: { pop: 0, food: 0, san: -5, def: -10 } }
            },
            {
                id: 3,
                npc: "ê¼¬ë§ˆ",
                image: "images/kid.png",
                text: "ì•„ì €ì”¨! í™˜ê¸°êµ¬ê°€ ë§‰í˜”ì–´ìš”. ì œê°€ ë“¤ì–´ê°€ì„œ ëš«ê³  ì˜¬ê¹Œìš”?",
                left: { text: "ë‹¤ë…€ì˜¤ë ´", effects: { pop: 0, food: 0, san: -10, def: 10 } },
                right: { text: "ìœ„í—˜í•´, ê°€ì§€ë§ˆ", effects: { pop: -5, food: 0, san: 5, def: -5 } }
            },
            {
                id: 4,
                npc: "ë¯¸ì¹˜ê´‘ì´ ì˜ì‚¬",
                image: "images/doctor.png",
                text: "3êµ¬ì—­ ì‚¬ëŒë“¤ì˜ í”¼ë¶€ì— ì´ìƒí•œ ë°˜ì ì´ ë‹ì•˜ìŠµë‹ˆë‹¤. ì‹¤í—˜í•´ë´ë„ ë ê¹Œìš”?",
                left: { text: "ê²©ë¦¬ ë° ì‹¤í—˜", effects: { pop: -10, food: 0, san: -10, def: 5 } },
                right: { text: "ì•½ë§Œ ì£¼ê³  ê´€ì°°", effects: { pop: 0, food: -10, san: 5, def: 0 } }
            },
            {
                id: 5,
                npc: "ì„±ì§ì",
                image: "images/priest.png",
                text: "ë²½ì— 'ê´€ë¦¬ìëŠ” ë¡œë´‡ì´ë‹¤'ë¼ëŠ” ë‚™ì„œê°€ ìˆìŠµë‹ˆë‹¤. ë²”ì¸ì„ ìƒ‰ì¶œí•©ì‹œë‹¤!",
                left: { text: "ì²˜ë²Œí•œë‹¤", effects: { pop: -5, food: 0, san: -10, def: 10 } },
                right: { text: "ë¬´ì‹œí•´", effects: { pop: 0, food: 0, san: 10, def: -10 } }
            },
            {
                id: 6,
                npc: "ë³´ê¸‰ê´€",
                image: "images/trader.png",
                text: "ì™¸ë¶€ ìƒì¸ì„ ë§Œë‚¬ìŠµë‹ˆë‹¤. ë¬´ê¸°ë¥¼ ì£¼ê³  ì‹ëŸ‰ì„ ì¢€ ì–»ì„ê¹Œìš”?",
                left: { text: "ê±°ë˜í•œë‹¤", effects: { pop: 0, food: 15, san: 0, def: -15 } },
                right: { text: "ì«“ì•„ë‚´", effects: { pop: 0, food: -5, san: 0, def: 5 } }
            },
            {
                id: 7,
                npc: "ê¸°ìˆ ì",
                image: "images/mechanic.png",
                text: "ì •ìˆ˜ ì‹œì„¤ì´ ê³ ì¥ ë‚¬ìŠµë‹ˆë‹¤. ê³ ì¹˜ë ¤ë©´ ë¶€í’ˆì´ í•„ìš”í•œë°, ë‚œë°©ê¸°ë¥¼ ëœ¯ì–´ì•¼ í•´ìš”.",
                left: { text: "ìˆ˜ë¦¬í•œë‹¤", effects: { pop: 0, food: 5, san: -5, def: 5 } },
                right: { text: "ê·¸ëƒ¥ ë‘”ë‹¤", effects: { pop: -10, food: -5, san: -5, def: 0 } }
            },
            {
                id: 8,
                npc: "ë¯¸ì¹˜ê´‘ì´ ì˜ì‚¬",
                image: "images/doctor.png",
                text: "ìƒˆë¡œìš´ ê°ì„±ì œë¥¼ ê°œë°œí–ˆìŠµë‹ˆë‹¤! ë³‘ì‚¬ë“¤ì—ê²Œ ë¨¹ì´ë©´ í˜ì´ ì„¸ì§ˆ ê²ë‹ˆë‹¤.",
                left: { text: "íˆ¬ì—¬í•œë‹¤", effects: { pop: -5, food: 0, san: -15, def: 20 } },
                right: { text: "ê±°ì ˆí•œë‹¤", effects: { pop: 0, food: 0, san: 5, def: -5 } }
            },
            {
                id: 9,
                npc: "ë³´ì•ˆëŒ€ì¥",
                image: "images/soldier.png",
                text: "ì‹ëŸ‰ ì°½ê³  ì¥ìƒˆë¼ë¥¼ ì¡ì•˜ìŠµë‹ˆë‹¤. ë³¸ë³´ê¸°ë¡œ ì²˜í˜•í• ê¹Œìš”?",
                left: { text: "ì²˜í˜•í•œë‹¤", effects: { pop: -1, food: 0, san: -10, def: 10 } },
                right: { text: "ìš©ì„œí•œë‹¤", effects: { pop: 0, food: -10, san: 5, def: -5 } }
            },
            {
                id: 10,
                npc: "ê¼¬ë§ˆ",
                image: "images/kid.png",
                text: "ì‹¬ì‹¬í•´ìš”. ë²½ì— ê·¸ë¦¼ ê·¸ë ¤ë„ ë¼ìš”?",
                left: { text: "ê·¸ëŸ¬ë ´", effects: { pop: 0, food: 0, san: 10, def: -5 } },
                right: { text: "ì•ˆ ë¼!", effects: { pop: 0, food: 0, san: -5, def: 0 } }
            }
        ];

        // [ê²Œì„ ìƒíƒœ ë³€ìˆ˜]
        let stats = { pop: 50, food: 50, def: 50, san: 50 };
        let currentEvent = null;

        // [DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°]
        const dom = {
            npcImg: document.getElementById('npc-img'),
            npcName: document.getElementById('npc-name'),
            question: document.getElementById('question-text'),
            bars: {
                pop: document.getElementById('bar-pop'),
                food: document.getElementById('bar-food'),
                def: document.getElementById('bar-def'),
                san: document.getElementById('bar-san')
            },
            btns: {
                left: document.getElementById('btn-left'),
                right: document.getElementById('btn-right')
            },
            overlays: {
                left: document.getElementById('overlay-left'),
                right: document.getElementById('overlay-right')
            },
            gameOver: {
                screen: document.getElementById('game-over-screen'),
                desc: document.getElementById('game-over-desc')
            }
        };

        // 1. ê²Œì„ ì‹œì‘
        function startGame() {
            stats = { pop: 50, food: 50, def: 50, san: 50 };
            dom.gameOver.screen.classList.add('hidden');
            updateStatsUI();
            loadNextEvent();
        }

        // 2. ë‹¤ìŒ ì´ë²¤íŠ¸ ë¡œë“œ (ëœë¤)
        function loadNextEvent() {
            const randomIndex = Math.floor(Math.random() * events.length);
            currentEvent = events[randomIndex];
            
            dom.npcImg.src = currentEvent.image;
            dom.npcName.innerText = currentEvent.npc;
            dom.question.innerText = currentEvent.text;
            
            // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            dom.btns.left.innerText = currentEvent.left.text;
            dom.btns.right.innerText = currentEvent.right.text;

            // ì˜¤ë²„ë ˆì´ ì´ˆê¸°í™”
            dom.overlays.left.style.opacity = 0;
            dom.overlays.right.style.opacity = 0;
        }

        // 3. ì„ íƒ ì²˜ë¦¬ ë¡œì§
        function handleChoice(direction) {
            if (!currentEvent) return;

            const choice = direction === 'left' ? currentEvent.left : currentEvent.right;
            const effects = choice.effects;

            // ìì› ë³€ë™ ì ìš©
            stats.pop += effects.pop;
            stats.food += effects.food;
            stats.def += effects.def;
            stats.san += effects.san;

            // UI ì—…ë°ì´íŠ¸ ë° ê²Œì„ ì˜¤ë²„ ì²´í¬
            updateStatsUI();
            
            // ì•½ê°„ì˜ ë”œë ˆì´ í›„ ê²Œì„ ì˜¤ë²„ íŒì • í˜¹ì€ ë‹¤ìŒ ì¹´ë“œ
            setTimeout(() => {
                const deathReason = checkGameOver();
                if (deathReason) {
                    showGameOver(deathReason);
                } else {
                    loadNextEvent();
                }
            }, 200);
        }

        // 4. ìì› UI ì—…ë°ì´íŠ¸ ë° í´ë¨í•‘(0~100 ì œí•œ)
        function updateStatsUI() {
            // ê°’ì„ 0~100 ì‚¬ì´ë¡œ ì œí•œ
            for (let key in stats) {
                if (stats[key] > 100) stats[key] = 100;
                if (stats[key] < 0) stats[key] = 0;
                
                // ë°” ê¸¸ì´ ì¡°ì ˆ
                dom.bars[key].style.width = stats[key] + '%';
            }
        }

        // 5. ê²Œì„ ì˜¤ë²„ ì²´í¬
        function checkGameOver() {
            if (stats.pop <= 0) return "ì‚¬ëŒì´ ëª¨ë‘ ì£½ì—ˆìŠµë‹ˆë‹¤. [ì¸êµ¬ 0]";
            if (stats.pop >= 100) return "ì‚°ì†Œê°€ ë¶€ì¡±í•´ ì§ˆì‹í–ˆìŠµë‹ˆë‹¤. [ì¸êµ¬ MAX]";
            if (stats.food <= 0) return "ëª¨ë‘ êµ¶ì–´ ì£½ì—ˆìŠµë‹ˆë‹¤. [ì‹ëŸ‰ 0]";
            if (stats.food >= 100) return "ì‹ëŸ‰ì´ ì©ì–´ ì—­ë³‘ì´ ëŒì•˜ìŠµë‹ˆë‹¤. [ì‹ëŸ‰ MAX]";
            if (stats.def <= 0) return "ì¢€ë¹„ë“¤ì—ê²Œ ë²™ì»¤ê°€ í•¨ë½ë˜ì—ˆìŠµë‹ˆë‹¤. [ë¬´ë ¥ 0]";
            if (stats.def >= 100) return "ë³´ì•ˆëŒ€ê°€ ì¿ ë°íƒ€ë¥¼ ì¼ìœ¼ì¼œ ë‹¹ì‹ ì„ ì²˜í˜•í–ˆìŠµë‹ˆë‹¤. [ë¬´ë ¥ MAX]";
            if (stats.san <= 0) return "í­ë™ì´ ì¼ì–´ë‚˜ ì«“ê²¨ë‚¬ìŠµë‹ˆë‹¤. [ì´ì„± 0]";
            if (stats.san >= 100) return "ë‹¹ì‹ ì„ ì‹ ìœ¼ë¡œ ëª¨ì‹œë‹¤ ì œë¬¼ë¡œ ë°”ì³¤ìŠµë‹ˆë‹¤. [ì´ì„± MAX]";
            return null;
        }

        // 6. ê²Œì„ ì˜¤ë²„ í™”ë©´ í‘œì‹œ
        function showGameOver(reason) {
            dom.gameOver.desc.innerText = reason;
            dom.gameOver.screen.classList.remove('hidden');
        }

        // [ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°]
        dom.btns.left.addEventListener('click', () => handleChoice('left'));
        dom.btns.right.addEventListener('click', () => handleChoice('right'));

        // [ì´ˆê¸° ì‹¤í–‰]
        startGame();

    </script>
</body>
</html>